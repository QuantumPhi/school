\documentclass[a4paper]{article}

\usepackage{amsmath, amssymb}
\usepackage{booktabs}
\usepackage[version=3]{mhchem}
\usepackage{pgfplots, pgfplotstable}
\usepackage{siunitx}

\def\abs#1{\left| #1 \right|}
\def\mean#1{\left< #1 \right>}
\newcommand{\pH}{\text{pH}}
\DeclareSIUnit\Molar{\textsc{m}}
\sisetup{
    round-mode=places,
    round-precision=2
}

\title{Analyzing the Relationship Between the Acidity and the Conductivity of a Solution}
\date{23 February 2015}
\author{Tarik Onalan}

\begin{document}
    \maketitle
    \section{Introduction}
        \subsection{Purpose}
            Understand how \pH{} of a solution affects conductivity measured in \si{\micro\siemens}.
        \subsection{Hypothesis}
            Conductivity will decrease as \pH{} approaches 7, as the ions that would
            otherwise facilitate the conduction of electricity (\ce{H+}/\ce{OH-})
            would be neutralized.
        \subsection{Variables}
            \textbf{Independent Variable}
            \begin{itemize}
                \item \pH{}
            \end{itemize}
            \textbf{Dependent Variable}
            \begin{itemize}
                \item Conductivity [\si{\micro\siemens}]
            \end{itemize}
            \textbf{Controlled Variables}
            \begin{itemize}
                \item Molarity of \ce{HCl}
                \item Molarity of \ce{NaOH}
                \item Volume of \ce{HCl} (\SI{50}{\mL})
                \item Drop rate of \ce{NaOH} ($\sim\SI{1}{\per\second}$)
                \item Spinning speed of stir bar
            \end{itemize}
    \section{Materials}
        \begin{itemize}
            \item \SI{150}{\mL} \SI{0.1}{\Molar} \ce{HCl}
            \item \SI{150}{\mL} \SI{0.1}{\Molar} \ce{NaOH}
            \item 1 $\cdot$ \SI{100}{\mL} buret$+$stand
            \item 1 $\cdot$ \SI{250}{\mL} beaker
            \item 1 $\cdot$ \SI{50}{\mL} graduated cylinder
            \item 1 $\cdot$ stir plate$+$bar
            \item 1 $\cdot$ logging device
            \item 1 $\cdot$ \pH{} probe
            \item 1 $\cdot$ conductivity probe
            \item 1 $\cdot$ USB flash disk
            \item Phenolphthalein
        \end{itemize}
    \section{Procedure}
        \begin{enumerate}
            \item Turn on logger
            \item Plug in \pH/conductivity probes and USB disk
            \item Set up buret with stand
            \item Put stir plate below buret
            \item Fill graduated cylinder with \SI{50}{\mL} \ce{HCl}
            \item Fill buret with \SI{50}{\mL} \ce{NaOH}
            \item Transfer \ce{HCl} to beaker
            \item Put 2-3 drops of phenolphthalein in the beaker
            \item Calibrate probes
            \item Put beaker on top of stir plate
            \item Put the stir bar in the beaker
            \item Set the stir bar spinning at $\frac{1}{4}$ speed
            \item Open the buret so there is $\sim1$ drop \si{\per\second}
            \item Start logger
            \item Let experiment run for 50 seconds
            \item Stop logger
            \item Export data to USB disk
            \item Release any remaining \ce{NaOH} into \ce{HCl} solution
            \item Turn off stir plate
            \item Remove stir bar
            \item Clean beaker
            \item Repeat $5-21$ as necessary for data collection
        \end{enumerate}
    \section{Data}
        \begin{table}[p]
            \begin{center}
                \caption{Trial 1}
                \label{trial1}
                \pgfplotstabletypeset[
                    multicolumn names,
                    col sep=comma,
                    display columns/0/.style={
                        column name=$Time$,
                        column type={S},string type},
                    display columns/1/.style={
                        column name=$\pH$,
                        column type={S},string type},
                    display columns/2/.style={
                        column name=$Conductivity$,
                        column type={S}, string type},
                    every head row/.style={
                        before row={\toprule},
                        after row={
                            \si\s & & \si{\micro\siemens}\\
                            \midrule}
                    },
                    columns/pH/.append style={
                        postproc cell content/.append style={
                            /pgfplots/table/@cell content/.add={}{$\pm0.20$}
                        }
                    },
                    columns/conductivity/.append style={
                        postproc cell content/.append style={
                            /pgfplots/table/@cell content/.add={}{$\pm800.$}
                        }
                    },
                    every last row/.style={after row=\bottomrule}
                ]{foo1.csv}
            \end{center}
        \end{table}
        \begin{table}[p]
            \begin{center}
                \caption{Trial 2}
                \label{trial2}
                \pgfplotstabletypeset[
                    multicolumn names,
                    col sep=comma,
                    display columns/0/.style={
                        column name=$Time$,
                        column type={S},string type},
                    display columns/1/.style={
                        column name=$\pH$,
                        column type={S},string type},
                    display columns/2/.style={
                        column name=$Conductivity$,
                        column type={S}, string type},
                    every head row/.style={
                        before row={\toprule},
                        after row={
                            \si\s & & \si{\micro\siemens}\\
                            \midrule}
                    },
                    columns/pH/.append style={
                        postproc cell content/.append style={
                            /pgfplots/table/@cell content/.add={}{$\pm0.20$}
                        }
                    },
                    columns/conductivity/.append style={
                        postproc cell content/.append style={
                            /pgfplots/table/@cell content/.add={}{$\pm800.$}
                        }
                    },
                    every last row/.style={after row=\bottomrule}
                ]{foo2.csv}
            \end{center}
        \end{table}
        \begin{table}[p]
            \begin{center}
                \caption{Trial 3}
                \label{trial3}
                \pgfplotstabletypeset[
                    multicolumn names,
                    col sep=comma,
                    display columns/0/.style={
                        column name=$Time$,
                        column type={S},string type},
                    display columns/1/.style={
                        column name=$\pH$,
                        column type={S},string type},
                    display columns/2/.style={
                        column name=$Conductivity$,
                        column type={S}, string type},
                    every head row/.style={
                        before row={\toprule},
                        after row={
                            \si\s & & \si{\micro\siemens}\\
                            \midrule}
                    },
                    columns/pH/.append style={
                        postproc cell content/.append style={
                            /pgfplots/table/@cell content/.add={}{$\pm0.20$}
                        }
                    },
                    columns/conductivity/.append style={
                        postproc cell content/.append style={
                            /pgfplots/table/@cell content/.add={}{$\pm800.$}
                        }
                    },
                    every last row/.style={after row=\bottomrule}
                ]{foo3.csv}
            \end{center}
        \end{table}
        \begin{table}[p]
            \begin{center}
                \caption{Average}
                \label{avg1}
                \pgfplotstabletypeset[
                    multicolumn names,
                    col sep=comma,
                    display columns/0/.style={
                        column name=$Time$,
                        column type={S},string type},
                    display columns/1/.style={
                        column name=$\pH$,
                        column type={S},string type},
                    display columns/2/.style={
                        column name=$Conductivity$,
                        column type={S}, string type},
                    every head row/.style={
                        before row={\toprule},
                        after row={
                            \si\s & & \si{\micro\siemens}\\
                            \midrule}
                    },
                    columns/pH/.append style={
                        postproc cell content/.append style={
                            /pgfplots/table/@cell content/.add={}{$\pm0.20$}
                        }
                    },
                    columns/conductivity/.append style={
                        postproc cell content/.append style={
                            /pgfplots/table/@cell content/.add={}{$\pm800.$}
                        }
                    },
                    every last row/.style={after row=\bottomrule}
                ]{avg1.csv}
            \end{center}
        \end{table}
        \begin{tikzpicture}
            \begin{axis}[
                scale=1.75,
                title={Conductivity Relative to $\pH$ of Solution},
                xlabel={Acidity [$\pH$]},
                ylabel={Conductivity [\si{\micro\siemens}]},
                legend pos=south west
            ]
                \addplot[
                    only marks
                ] plot [
                    error bars/.cd,
                        x dir=both,
                        y dir=both,
                        x explicit,
                        y explicit,
                        x fixed=0.2,
                        y fixed=800
                ] table [
                    x=pH,
                    y=conductivity,
                    col sep=comma
                ]{avg1.csv};
                \addplot[
                    color=red,
                    mark=none,
                    very thick,
                    domain=0.74:1.34
                ]{361.37670717*ln(-8958.19654783*x+12474.08390013)+16235.19889257};
                \addlegendentry{Average}
                \addlegendentry{$361.4ln(-8958.2x+12474.1)+16235.2$}
            \end{axis}
        \end{tikzpicture}
    \newpage
    \section{Calculations}
        \subsection{Average}
            \begin{equation}
                \mean{\si{\micro\siemens}(\pH_i)}
            \end{equation}
            \begin{equation}
                \frac{\displaystyle\sum_i{\si{\micro\siemens}(\pH_i)}}{i}
            \end{equation}
            \begin{equation}
                \frac{\si{\micro\siemens}(\pH_1)+\si{\micro\siemens}(\pH_2)+...+\si{\micro\siemens}(\pH_{i-1})+\si{\micro\siemens}(\pH_i)}{i}
            \end{equation}
        \subsection{Pearson Correlation Coefficient}
            \centerline{The Pearson Correlation Coefficient $r_{x,y}$ is defined as}
            \begin{equation}
                r_{x,y}=\frac{\displaystyle\sum_{i=1}^n{cov(x,y)}}{\sigma_x\sigma_y}
            \end{equation}
            \begin{center}
                where $cov(x,y)$ is the covariance and $\sigma_x/\sigma_y$ are
                the standard deviations of sets $x$ and $y$. This can be expanded
                to
            \end{center}
            \begin{equation}
                r_{x,y}=\frac{\displaystyle\sum_{i=1}^n{(x_i-\overline{x})(y_i-\overline{y})}}{\displaystyle\sum_{i=1}^n{(x_i-\overline{x})^2}\displaystyle\sum_{i=1}^n{(y_i-\overline{y})^2}}
            \end{equation}
            \begin{center}
                where $\overline{x}/\overline{y}$ are the averages of sets $x$ and $y$.
                $r_{x,y}$ was then calculated by substituting sets $x$ and $y$ with the
                \pH{} and conductivity sets, respectively.
            \end{center}
        \subsection{Error and Minimization}
            \centerline{Error was calculated using sum squared error, which is defined as follows:}
            \begin{equation}
                E=\displaystyle\sum_{i=1}^n{(y_i-f(x_i))^2}
            \end{equation}
            \begin{center}
                While a program carried out the minimization of the function, the basic
                premise of minimization is to ``follow the gradient,'' so to speak. The
                program follows the gradient
            \end{center}
            \begin{equation}
                E'=\frac{\partial}{\partial x}(\displaystyle\sum_{i=1}^n{(y_i-f(x_i))^2})
            \end{equation}
            \begin{center}
                similar to Euler's method for solving differential equations. Minimizing
                the function is simply following the ``negative'' slope to the local minima
                of the function.
            \end{center}
        \subsection{Line of Best Fit}
            \begin{center}
                While creating my best fit line, I took into account the axis units.
                \pH{} is a logarithmic scale, and \si{\micro\siemens} is a linear
                scale. From there, I hypothesized that my line of best fit would be
                logarithmic in nature.
            \end{center}
            \begin{equation}
                f(x)=kln(px+g)+h
            \end{equation}
            \centerline{This produced lower error than a second degree polynomial,}
            \begin{equation}
                g(x)=ax^2+bx+c
            \end{equation}
            \begin{center}
                \bf{Error}
                \\
                \begin{tabular}{|c|c|c|}
                    \hline
                    $f(x)$ & $g(x)$
                    \\\hline
                    $27393.7063196$ & $46056.2186406$
                    \\\hline
                \end{tabular}
            \end{center}
    \section{Conclusion}
        My hypothesis, that the conductivity would decrease as \pH{} approached $7$, was
        partially correct. I was only able to test with an acidic starting point, meaning
        that I only observed the \pH{} approaching $7$ from $0\le{\pH}<{7}$. However, I can
        conclude that as the \pH{} approaches $7$ from $0\le{\pH}<{7}$, the conductivity decreases.
        Simply from a mathematical standpoint, the Pearson correlation coefficient---the measure of the
        ``correlatedness'' of any two datasets---of the \pH and conductivity returns
        $-0.95$, which is an almost exact (negative) linear relationship. This is evident
        by looking at the graph, which shows that as the \pH{} increased, the conductivity
        decreased. When the \pH{} was $\sim0.74$ (starting \pH), the conductivity was
        \SI{19348.0}{\micro\siemens}. When the \pH{} increased to $\sim1.34$, however,
        the conductivity decreased to \SI{18453.7}{\micro\siemens}. Of course, there are
        many more values in between, but the general trend is similar to the one described.
        \\\\
        The biggest difficulty I had in my lab was keeping the probes calibrated.
        In my lab, I was using \SI{0.1}{\Molar} \ce{HCl} and \ce{NaOH}, which have \pH{}
        values of $1$ and $13$, respectively. However, the \pH{} probe in particular
        would not hold its calibration, and in my second and third trials, the starting \pH{}
        of the \ce{HCl} is incorrectly reported as $0.82$ and $0.40$. Even so, this does not
        invalidate my conclusion, because there is still an obvious downward trend in the
        conductivity-\pH{} data.
        \\\\
        In the future, I could compensate for probe calibration issues by running more
        trials, so that I could average away systematic error. In this lab, I only had
        enough time to run 3 trials, but, in the future, I could run more trials
        to compensate for sensor drift.
\end{document}
